<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Barcode Slideshow — Code128</title>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #ffffff;
      color: #000;
      margin: 0;
      padding: 20px;
    }

    .container {
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 20px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .panel {
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 16px;
      background: #f9f9f9;
    }

    textarea {
      width: 100%;
      min-height: 240px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      resize: vertical;
      font-size: 15px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    button {
      padding: 8px 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }

    button.play { background: #4caf50; color: white; }
    button.pause { background: #999; color: white; }
    button.red { background: #e53935; color: white; }
    button.ghost { background: #f0f0f0; color: #000; }
    .display {
      text-align: center;
      background: #ffffff;
      border-radius: 10px;
      padding: 20px;
      border: 1px solid #ccc;
    }

    .barcode-wrap {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 320px;
      background: #ffffff;
    }

    svg#barcode {
      width: 90%;
      height: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <section class="panel">
      <h2>Barcode Slideshow — Code128</h2>
      <textarea id="codes" placeholder="Enter one code per line..."></textarea>
      <div>
        <label>Time per slide (seconds):</label>
        <input type="number" id="timeInput" value="5" min="1" max="60" />
      </div>
      <div class="controls">
        <button class="play" id="playBtn">Play</button>
        <button class="pause" id="pauseBtn">Pause</button>
        <button class="ghost" id="prevBtn">◀ Prev</button>
        <button class="ghost" id="nextBtn">Next ▶</button>
        <button class="red" id="clearBtn">Clear</button>
        <button class="ghost" id="fsBtn">Fullscreen</button>
      </div>
    </section>

    <section class="panel display" id="displayPanel">
      <div><span id="indexLabel">0 / 0</span></div>
      <div class="barcode-wrap"><svg id="barcode"></svg></div>
      <div id="currentText">—</div>
    </section>
  </div>

  <script>
    const ta=document.getElementById('codes');
    const barcodeSvg=document.getElementById('barcode');
    const currentText=document.getElementById('currentText');
    const indexLabel=document.getElementById('indexLabel');
    const playBtn=document.getElementById('playBtn');
    const pauseBtn=document.getElementById('pauseBtn');
    const nextBtn=document.getElementById('nextBtn');
    const prevBtn=document.getElementById('prevBtn');
    const clearBtn=document.getElementById('clearBtn');
    const fsBtn=document.getElementById('fsBtn');
    const displayPanel=document.getElementById('displayPanel');
    const timeInput=document.getElementById('timeInput');

    let timer=null; let codes=[]; let idx=0; let slideTime=5000;

    function sanitize(lines){return lines.map(s=>(s||'').trim()).filter(s=>s.length>0);}
    function refreshCodes(){codes=sanitize(ta.value.split(/\r?\n/)); render();}
    function render(){
      const total=codes.length;
      indexLabel.textContent=total?`${idx+1} / ${total}`:'0 / 0';
      const text=total?codes[idx]:'—';
      currentText.textContent=text;
      while(barcodeSvg.firstChild) barcodeSvg.removeChild(barcodeSvg.firstChild);
      if(total){
        JsBarcode(barcodeSvg,text,{
          format:'code128',
          displayValue:true,
          fontSize:22,
          lineColor:'#000000',
          background:'#ffffff',
          width:2,
          height:120
        });
      } else {
        const note=document.createElementNS('http://www.w3.org/2000/svg','text');
        note.setAttribute('x','50%');
        note.setAttribute('y','50%');
        note.setAttribute('text-anchor','middle');
        note.setAttribute('fill','#888');
        note.textContent='Enter codes on the left';
        barcodeSvg.appendChild(note);
      }
    }

    function play(){if(!codes.length) return; if(timer) return; timer=setInterval(()=>{idx=(idx+1)%codes.length; render();},slideTime);}
    function pause(){if(timer){clearInterval(timer); timer=null;}}
    function next(){if(!codes.length) return; idx=(idx+1)%codes.length; render();}
    function prev(){if(!codes.length) return; idx=(idx-1+codes.length)%codes.length; render();}
    function clearAll(){pause(); ta.value=''; refreshCodes();}
    function toggleFullscreen(){if(!document.fullscreenElement) displayPanel.requestFullscreen(); else document.exitFullscreen();}
    playBtn.onclick=play; pauseBtn.onclick=pause; nextBtn.onclick=next; prevBtn.onclick=prev; clearBtn.onclick=clearAll; fsBtn.onclick=toggleFullscreen;
    ta.oninput=refreshCodes;
    timeInput.onchange=()=>{slideTime=parseInt(timeInput.value)*1000; if(timer){pause(); play();}};
  </script>
</body>
</html>
